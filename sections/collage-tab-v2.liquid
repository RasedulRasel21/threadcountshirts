
{%- liquid
 assign tab_inline_style = '--tab-image-width: ' | append: section.settings.desktop_image_width | append: '%;'
-%}


{%- style -%}
/* Collage Tabs V2 - Dynamic CSS */
#shopify-section-{{ section.id }} .collage-tabs-v2 {
 padding-top: {{ section.settings.padding_top }}px;
 padding-bottom: {{ section.settings.padding_bottom }}px;
}


#shopify-section-{{ section.id }} .collage-tabs-v2 .page-width {
 max-width: 1200px;
 margin: 0 auto;
 padding: 0 20px;
}


/* Tabs Header */
#shopify-section-{{ section.id }} .tabs__header {
 margin-bottom: 3.2rem;
 column-gap: 1.6rem;
}


#shopify-section-{{ section.id }} .tabs__nav-wrap {
 display: flex;
 position: relative;
 overflow: hidden;
 max-width: 100%;
}


#shopify-section-{{ section.id }} .tabs__nav {
 display: inline-grid;
 grid-auto-flow: column;
 grid-auto-columns: max-content;
 justify-content: flex-start;
 vertical-align: top;
 overflow-y: hidden;
 overflow-x: auto;
 -ms-overflow-style: none;
 scrollbar-width: none;
 gap: 0 3.2rem;
}


#shopify-section-{{ section.id }} .tabs__nav::-webkit-scrollbar {
 display: none;
}


#shopify-section-{{ section.id }} .tabs__tab {
 position: relative;
 cursor: pointer;
 transition: all 0.3s ease;
 background: none;
 border: none;
 white-space: unset;
 height: auto;
 margin: 0;
 padding: 0 0 0.4rem;
 font-size: var(--font-body-size);
 line-height: var(--font-body-line-height);
}


#shopify-section-{{ section.id }} .tabs__tab span {
 color: rgb(var(--color-foreground));
}


#shopify-section-{{ section.id }} .tabs__tab:hover span,
#shopify-section-{{ section.id }} .tabs__tab[aria-selected="true"] span {
 color: rgb(var(--color-foreground));
}


#shopify-section-{{ section.id }} .tabs__tab:before {
 content: "";
 display: block;
 background: rgb(var(--color-foreground));
 width: 0;
 height: 1px;
 position: absolute;
 inset-inline: auto 0;
 bottom: 0;
 transition: 0.25s width ease-in-out;
}


#shopify-section-{{ section.id }} .tabs__tab:hover:before,
#shopify-section-{{ section.id }} .tabs__tab[aria-selected="true"]:before {
 width: 100%;
 inset-inline: 0 auto;
}


/* Tab Panel */
#shopify-section-{{ section.id }} .tabs__panel {
 position: relative;
}


#shopify-section-{{ section.id }} .tabs__content {
 opacity: 1;
 transition: opacity 0.3s ease, transform 0.3s ease;
}


#shopify-section-{{ section.id }} .tabs__content[hidden] {
 display: none;
}


/* Collage Tab Content */
#shopify-section-{{ section.id }} .collage-tab__image {
 width: 100%;
}


#shopify-section-{{ section.id }} .collage-tab__image img,
#shopify-section-{{ section.id }} .collage-tab__image svg {
 width: 100%;
 height: 100%;
 object-fit: cover;
}


#shopify-section-{{ section.id }} .collage-tab__content {
 max-width: 100%;
 padding: 4.8rem 2rem;
 word-wrap: break-word;
}


.rich-text__button a{
 color: #121212;
 text-underline-offset: 6px;
}


#shopify-section-{{ section.id }} .collage-tab__content-inner {
 width: 57rem;
 max-width: 100%;
 margin: 0 auto;
}


#shopify-section-{{ section.id }} .blocks-radius {
 border-radius: 12px;
 overflow: hidden;
}


#shopify-section-{{ section.id }} .media-wrapper {
 position: relative;
 overflow: hidden;
}


#shopify-section-{{ section.id }} .media-wrapper img {
 display: block;
}


#shopify-section-{{ section.id }} .placeholder-svg {
 width: 100%;
 height: auto;
 background-color: #e0e0e0;
}


/* Rich Text Styles */
#shopify-section-{{ section.id }} .rich-text__subheading {
 margin-bottom: 1.6rem;
 opacity: 0.7;
}


#shopify-section-{{ section.id }} .rich-text__heading {
 margin-bottom: 2.4rem;
 line-height: 1.2;
}


#shopify-section-{{ section.id }} .rich-text__text {
 margin-bottom: 2.4rem;
 line-height: 1.6;
}


#shopify-section-{{ section.id }} .rich-text__button {
 margin-top: 1.6rem;
}


/* Text Alignment */
#shopify-section-{{ section.id }} .text-left {
 text-align: left;
}


#shopify-section-{{ section.id }} .text-center {
 text-align: center;
}


#shopify-section-{{ section.id }} .text-right {
 text-align: right;
}


/* Highlight Text Styles */
#shopify-section-{{ section.id }} .highlight-text--underline {
 position: relative;
 font-style: normal;
 text-decoration: underline;
 text-decoration-thickness: 2px;
 text-underline-offset: 4px;
}


/* Flex Utilities */
#shopify-section-{{ section.id }} .flex {
 display: flex;
}


#shopify-section-{{ section.id }} .flex-wrap {
 flex-wrap: wrap;
}


#shopify-section-{{ section.id }} .flex-col {
 flex-direction: column;
}


#shopify-section-{{ section.id }} .flex-1 {
 flex: 1;
}


#shopify-section-{{ section.id }} .items-center {
 align-items: center;
}


#shopify-section-{{ section.id }} .w-full {
 width: 100%;
}


#shopify-section-{{ section.id }} .block {
 display: block;
}


#shopify-section-{{ section.id }} .justify-start {
 justify-content: flex-start;
}


#shopify-section-{{ section.id }} .justify-center {
 justify-content: center;
}


#shopify-section-{{ section.id }} .justify-end {
 justify-content: flex-end;
}


/* Desktop Styles */
@media (min-width: 768px) {
 #shopify-section-{{ section.id }} .collage-tab__image {
   width: var(--tab-image-width, 50%);
 }


 #shopify-section-{{ section.id }} .collage-tab__content {
   max-width: calc(100% - var(--tab-image-width, 50%));
   padding: 4.8rem 3.2rem;
 }


 #shopify-section-{{ section.id }} .md\:order-last {
   order: 9999;
 }
}


/* Mobile Styles */
@media (max-width: 767px) {
 #shopify-section-{{ section.id }} .tabs__header {
   margin-bottom: 1.2rem;
 }


 #shopify-section-{{ section.id }} .tabs__nav-wrap {
   justify-content: center;
   min-width: 100%;
   max-width: calc(100% + 3rem);
   margin-inline: -1.5rem;
 }


 #shopify-section-{{ section.id }} .tabs__nav {
   gap: 0 3.2rem;
   padding-inline: 1.5rem;
 }
}
{%- endstyle -%}


<script>
// Collage Tabs V2 - Embedded JavaScript
(function() {
 if (!customElements.get('collage-tabs-v2')) {
   class CollageTabsV2 extends HTMLElement {
     constructor() {
       super();
       this.tabButtons = [];
       this.tabPanels = [];
       this.selectedIndex = 0;
     }


     connectedCallback() {
       // Use setTimeout to ensure DOM is ready
       setTimeout(() => {
         this.init();
       }, 0);


       // Support Shopify theme editor
       if (window.Shopify && window.Shopify.designMode) {
         document.addEventListener('shopify:section:load', (event) => {
           if (event.target.contains(this)) {
             this.resetAndInit();
           }
         });
       }
     }


     init() {
       this.tabButtons = Array.from(this.querySelectorAll('[role="tab"]'));
       this.tabPanels = Array.from(this.querySelectorAll('[role="tabpanel"]'));


       if (this.tabButtons.length === 0 || this.tabPanels.length === 0) return;


       this.setupAccessibility();
       this.attachEventListeners();
       this.setActiveTab(0);
     }


     resetAndInit() {
       this.disconnectedCallback();
       this.init();
     }


     setupAccessibility() {
       this.tabButtons.forEach((tab, index) => {
         tab.setAttribute('aria-selected', index === 0);
         tab.setAttribute('data-index', index);


         if (tab.id && this.tabPanels[index]) {
           this.tabPanels[index].setAttribute('aria-labelledby', tab.id);
         }
       });


       this.tabPanels.forEach((panel, index) => {
         panel.setAttribute('tabindex', 0);


         if (panel.id && this.tabButtons[index]) {
           this.tabButtons[index].setAttribute('aria-controls', panel.id);
         }
       });
     }


     attachEventListeners() {
       this.tabButtons.forEach((tab, index) => {
         tab.addEventListener('click', (e) => {
           e.preventDefault();
           this.setActiveTab(index);
         });
       });


       const tabHeader = this.querySelector('[role="tablist"]');
       if (tabHeader) {
         tabHeader.addEventListener('keydown', (e) => this.handleKeyDown(e));
       }
     }


     async setActiveTab(tabIndex) {
       if (tabIndex < 0 || tabIndex >= this.tabButtons.length) return;


       const previousIndex = this.selectedIndex;
       const previousPanel = this.tabPanels[previousIndex];
       const newPanel = this.tabPanels[tabIndex];


       // Update button states
       this.tabButtons.forEach((btn, index) => {
         btn.setAttribute('aria-selected', index === tabIndex);
       });


       // Transition panels
       if (previousPanel && newPanel && previousIndex !== tabIndex) {
         await this.transition(previousPanel, newPanel);
       } else if (newPanel) {
         newPanel.hidden = false;
       }


       this.selectedIndex = tabIndex;


       // Dispatch custom event
       this.dispatchEvent(new CustomEvent('tabChange', {
         bubbles: true,
         detail: { selectedIndex: tabIndex, selectedTab: newPanel }
       }));
     }


     async transition(fromPanel, toPanel) {
       // Simple fade transition
       fromPanel.style.opacity = '1';
       fromPanel.style.transform = 'translateY(0)';


       // Animate out
       await this.animate(fromPanel, {
         opacity: 0,
         transform: 'translateY(2rem)'
       }, 300);


       fromPanel.hidden = true;
       toPanel.hidden = false;


       toPanel.style.opacity = '0';
       toPanel.style.transform = 'translateY(2rem)';


       // Animate in
       await this.animate(toPanel, {
         opacity: 1,
         transform: 'translateY(0)'
       }, 300);
     }


     animate(element, properties, duration) {
       return new Promise(resolve => {
         element.style.transition = `all ${duration}ms ease`;


         Object.keys(properties).forEach(prop => {
           element.style[prop] = properties[prop];
         });


         setTimeout(() => {
           element.style.transition = '';
           resolve();
         }, duration);
       });
     }


     handleKeyDown(e) {
       // Right arrow
       if (e.keyCode === 39) {
         e.preventDefault();
         this.tabButtons[this.selectedIndex].setAttribute('tabindex', -1);
         this.selectedIndex++;


         if (this.selectedIndex >= this.tabButtons.length) {
           this.selectedIndex = 0;
         }


         this.setActiveTab(this.selectedIndex);
         this.tabButtons[this.selectedIndex].setAttribute('tabindex', 0);
         this.tabButtons[this.selectedIndex].focus();
       }
       // Left arrow
       else if (e.keyCode === 37) {
         e.preventDefault();
         this.tabButtons[this.selectedIndex].setAttribute('tabindex', -1);
         this.selectedIndex--;


         if (this.selectedIndex < 0) {
           this.selectedIndex = this.tabButtons.length - 1;
         }


         this.setActiveTab(this.selectedIndex);
         this.tabButtons[this.selectedIndex].setAttribute('tabindex', 0);
         this.tabButtons[this.selectedIndex].focus();
       }
     }


     disconnectedCallback() {
       // Clean up event listeners if needed
     }
   }


   customElements.define('collage-tabs-v2', CollageTabsV2);
 }
})();
</script>


<div
 class="collage-tabs-v2 section section-{{ section.id }} gradient color-{{ section.settings.color_scheme }}{% if section.settings.custom_class != blank %} {{ section.settings.custom_class }}{% endif %}"
>
 <div class="page-width">
   {%- if section.blocks.size > 0 -%}
     <collage-tabs-v2 class="tabs tabs__nav-design-1">
       <div
         class="tabs__header flex justify-{{ section.settings.desktop_navigation_alignment }}"
         role="tablist"
       >
         <div class="tabs__nav-wrap">
           <div class="tabs__nav">
             {%- for block in section.blocks -%}
               {%- liquid
                 if block.settings.navigation_title != blank
                   assign tab_name = block.settings.navigation_title
                 else
                   assign tab_name = 'Tab ' | append: forloop.index
                 endif
               -%}
               <button class="tabs__tab focus-inset" role="tab" id="{{- block.id -}}" {{ block.shopify_attributes }}>
                 <span class="tabs__tab-name {{ section.settings.heading_size }}">{{- tab_name -}}</span>
               </button>
             {%- endfor -%}
           </div>
         </div>
       </div>
       <div class="tabs__panel">
         {%- for block in section.blocks -%}
           {%- liquid
             assign aspect_ratio = section.settings.image_aspect_ratio | default: '1/1'
             if aspect_ratio == 'adapt'
               if block.settings.image != blank
                 assign aspect_ratio = block.settings.image.aspect_ratio
               else
                 assign aspect_ratio = '1/1'
               endif
             endif


             assign loading = 'lazy'
             assign fetchpriority = 'low'
             if section.index < 2 and forloop.index == 1
               assign loading = 'eager'
               assign fetchpriority = 'high'
             endif
           -%}
           <div
             class="tabs__content"
             id="tab-{{ block.id }}"
             data-index="{{ forloop.index0 }}"
             role="tabpanel"
             {% unless forloop.first %}
               hidden
             {% endunless %}
           >
             <div
               class="blocks-radius flex flex-wrap color-{{ block.settings.content_color_scheme }}"
               style="{{ tab_inline_style }}"
             >
               <div
                 class="collage-tab__image media-wrapper{% if block.settings.image == blank %} bg-none{% endif %}{% if section.settings.desktop_image_position == 'right' %} md:order-last{% endif %}"
                 style="--aspect-ratio: {{ aspect_ratio }};"
               >
                 {%- if block.settings.image != blank -%}
                   {{
                     block.settings.image
                     | image_url: width: 750
                     | image_tag:
                       loading: loading,
                       fetchpriority: fetchpriority,
                       widths: '375, 550, 750, 1100, 1500, 1780, 2000, 3000, 3840'
                   }}
                 {%- else -%}
                   {{ 'image' | placeholder_svg_tag: 'placeholder-svg' }}
                 {%- endif -%}
               </div>
               <div class="collage-tab__content flex-1 flex items-center">
                 <div class="collage-tab__content-inner rich-text flex flex-col w-full text-{{ block.settings.text_alignment }}">
                   {%- if block.settings.subheading != blank -%}
                     <div class="block rich-text__subheading text-subheading">
                       {{ block.settings.subheading }}
                     </div>
                   {%- endif -%}
                   {%- if block.settings.heading != blank -%}
                     <h2 class="rich-text__heading inline-richtext {{ block.settings.heading_size }}">
                       <span class="block">
                         {%- liquid
                           assign heading_text = block.settings.heading
                           assign style = block.settings.heading_highlight_style


                           if style == 'none'
                             echo heading_text
                           else
                             assign css_class = 'highlight-text highlight-text--underline'
                             assign em_open_tag = '<em class="' | append: css_class | append: '">'
                             assign em_close_tag = '</em>'


                             assign highlight_text = heading_text | replace: '<em>', em_open_tag
                             assign highlight_text = highlight_text | replace: '</em>', em_close_tag


                             echo highlight_text
                           endif
                         -%}
                       </span>
                     </h2>
                   {%- endif -%}
                   {%- if block.settings.description != blank -%}
                     <div class="block rich-text__text rte {{ block.settings.text_size }}">
                       {{ block.settings.description }}
                     </div>
                   {%- endif -%}
                   {%- if block.settings.button_label != blank -%}
                     <div class="block rich-text__button">
                       <a
                         class="btn {{ block.settings.button_style }}"
                         {% if block.settings.button_link != blank %}
                           href="{{ block.settings.button_link }}"
                         {% else %}
                           aria-disabled="true"
                         {% endif %}
                       >
                         {{- block.settings.button_label -}}
                       </a>
                     </div>
                   {% endif %}
                 </div>
               </div>
             </div>
           </div>
         {%- endfor -%}
       </div>
     </collage-tabs-v2>
   {%- endif -%}
 </div>
</div>


{% schema %}
{
 "name": "Collage Tabs V2",
 "tag": "section",
 "settings": [
   {
     "type": "header",
     "content": "General"
   },
   {
     "type": "color_scheme",
     "id": "color_scheme",
     "label": "Color scheme",
     "default": "scheme-1"
   },
   {
     "type": "header",
     "content": "Tab Settings"
   },
   {
     "type": "select",
     "id": "heading_size",
     "label": "Tab heading size",
     "default": "h4",
     "options": [
       {
         "value": "h6",
         "label": "Extra Small"
       },
       {
         "value": "h5",
         "label": "Small"
       },
       {
         "value": "h4",
         "label": "Medium Small"
       },
       {
         "value": "h3",
         "label": "Medium"
       },
       {
         "value": "h2",
         "label": "Large"
       },
       {
         "value": "h1",
         "label": "Extra Large"
       },
       {
         "value": "hd3",
         "label": "Display Small"
       },
       {
         "value": "hd2",
         "label": "Display Medium"
       },
       {
         "value": "hd1",
         "label": "Display Large"
       }
     ]
   },
   {
     "type": "select",
     "id": "desktop_navigation_alignment",
     "label": "Desktop navigation alignment",
     "default": "center",
     "options": [
       {
         "value": "start",
         "label": "Left"
       },
       {
         "value": "center",
         "label": "Center"
       },
       {
         "value": "end",
         "label": "Right"
       }
     ]
   },
   {
     "type": "select",
     "id": "desktop_image_position",
     "label": "Desktop image position",
     "default": "left",
     "options": [
       {
         "value": "left",
         "label": "Left"
       },
       {
         "value": "right",
         "label": "Right"
       }
     ]
   },
   {
     "type": "range",
     "id": "desktop_image_width",
     "label": "Desktop image width",
     "default": 50,
     "min": 30,
     "max": 70,
     "step": 1,
     "unit": "%"
   },
   {
     "type": "select",
     "id": "image_aspect_ratio",
     "label": "Image aspect ratio",
     "default": "adapt",
     "options": [
       {
         "value": "adapt",
         "label": "Adapt to image"
       },
       {
         "value": "1/1",
         "label": "1:1"
       },
       {
         "value": "3/4",
         "label": "3:4"
       },
       {
         "value": "4/3",
         "label": "4:3"
       }
     ]
   },
   {
     "type": "header",
     "content": "Section Padding"
   },
   {
     "type": "range",
     "id": "padding_top",
     "label": "Padding top",
     "default": 50,
     "min": 0,
     "max": 100,
     "step": 2,
     "unit": "px"
   },
   {
     "type": "range",
     "id": "padding_bottom",
     "label": "Padding bottom",
     "default": 50,
     "min": 0,
     "max": 100,
     "step": 2,
     "unit": "px"
   },
   {
     "type": "header",
     "content": "Custom Attributes"
   },
   {
     "type": "text",
     "id": "custom_class",
     "label": "Custom class"
   }
 ],
 "blocks": [
   {
     "type": "tab",
     "name": "Tab",
     "settings": [
       {
         "type": "color_scheme",
         "id": "content_color_scheme",
         "label": "Color scheme",
         "default": "scheme-2"
       },
       {
         "type": "text",
         "label": "Navigation title",
         "id": "navigation_title"
       },
       {
         "type": "image_picker",
         "label": "Image",
         "id": "image"
       },
       {
         "type": "inline_richtext",
         "id": "heading",
         "label": "Heading",
         "default": "Collapsible tabs"
       },
       {
         "type": "select",
         "id": "heading_size",
         "label": "Heading size",
         "default": "h1",
         "options": [
           {
             "value": "h6",
             "label": "Extra Small"
           },
           {
             "value": "h5",
             "label": "Small"
           },
           {
             "value": "h4",
             "label": "Medium Small"
           },
           {
             "value": "h3",
             "label": "Medium"
           },
           {
             "value": "h2",
             "label": "Large"
           },
           {
             "value": "h1",
             "label": "Extra Large"
           },
           {
             "value": "hd3",
             "label": "Display Small"
           },
           {
             "value": "hd2",
             "label": "Display Medium"
           },
           {
             "value": "hd1",
             "label": "Display Large"
           }
         ]
       },
       {
         "type": "header",
         "content": "Highlight Text"
       },
       {
         "type": "paragraph",
         "content": "Wrap text in <em> tags to apply highlight style"
       },
       {
         "type": "select",
         "id": "heading_highlight_style",
         "label": "Highlight style",
         "options": [
           {
             "value": "none",
             "label": "None"
           },
           {
             "value": "underline",
             "label": "Underline"
           }
         ]
       },
       {
         "type": "text",
         "id": "subheading",
         "label": "Subheading"
       },
       {
         "type": "richtext",
         "id": "description",
         "label": "Description"
       },
       {
         "type": "select",
         "id": "text_size",
         "label": "Text size",
         "default": "text-base",
         "options": [
           {
             "value": "text-sm",
             "label": "Small"
           },
           {
             "value": "text-base",
             "label": "Base"
           },
           {
             "value": "text-lg",
             "label": "Large"
           },
           {
             "value": "text-inherit",
             "label": "Inherit"
           }
         ]
       },
       {
         "type": "select",
         "id": "text_alignment",
         "label": "Text alignment",
         "default": "center",
         "options": [
           {
             "value": "left",
             "label": "Left"
           },
           {
             "value": "center",
             "label": "Center"
           },
           {
             "value": "right",
             "label": "Right"
           }
         ]
       },
       {
         "type": "header",
         "content": "Button"
       },
       {
         "type": "text",
         "id": "button_label",
         "label": "Button label"
       },
       {
         "type": "url",
         "id": "button_link",
         "label": "Button link"
       },
       {
         "type": "select",
         "id": "button_style",
         "label": "Button style",
         "options": [
           {
             "value": "btn--primary",
             "label": "Primary"
           },
           {
             "value": "btn--secondary",
             "label": "Secondary"
           },
           {
             "value": "btn--underline",
             "label": "Underline"
           }
         ],
         "default": "btn--primary"
       }
     ]
   }
 ],
 "presets": [
   {
     "name": "Collage Tabs V2",
     "blocks": [
       {
         "type": "tab",
         "settings": {
           "navigation_title": "Tab 1",
           "heading": "Collage tab heading",
           "description": "<p>Fill in the text content of the tab item here. You can provide details information tab item here.</p>",
           "button_label": "Button label"
         }
       },
       {
         "type": "tab",
         "settings": {
           "navigation_title": "Tab 2",
           "heading": "Collage tab heading",
           "description": "<p>Fill in the text content of the tab item here. You can provide details information tab item here.</p>",
           "button_label": "Button label"
         }
       }
     ]
   }
 ],
 "disabled_on": {
   "groups": ["footer", "header", "custom.overlay"]
 }
}
{% endschema %}


